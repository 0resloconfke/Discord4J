apply plugin: 'com.github.johnrengelman.shadow'

shadowJar {
    baseName = 'Discord4J'
    classifier = 'shaded'
    manifest {
        def git_cmd = 'git describe --tags --always --long'
        // TODO: Fix for when Git is unavailable
        // def git_proc = git_cmd.execute()
        // attributes 'SCM-Revision': git_proc.text.trim()
        attributes 'Timestamp': String.valueOf(System.currentTimeMillis())
        attributes 'Build-Host': InetAddress.localHost.hostName
    }
}

dependencies {
    compile project(':rest')
    compile project(':gateway')
    compile project(':store')

    testCompile "junit:junit:$junit_version"

    testRuntime "ch.qos.logback:logback-classic:$logback_version"
}

publishing {
    publications {
        core(MavenPublication) {
            artifactId 'discord4j-core'

            from components.java

            artifact sourcesJar
            artifact javadocJar
        }
    }
}